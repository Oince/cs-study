> 이 포스팅은 주홍철 저 '면접을 위한 CS 전공지식 노트' 2.4장을 토대로 작성되었습니다.

## ✅ IP 주소와 MAC 주소 개념

-   IP 주소 = Internet Protocol 주소

네트워크에 연결된 컴퓨터, 서버, 스마트폰 등 장치의 위치를 나타내는 주소로,

인터넷 세상에서 집 주소 같은 역할을 합니다.

인터넷 계층에 해당하는 논리적 주소로,

장치가 네트워크에 연결될 때 할당되어 필요에 따라 변경 가능하며, 다른 네트워크로 데이터를 전달할 때 사용합니다.

네트워크 안에서 장치를 구분하는 역할로 패킷이 목적지 네트워크까지 올바르게 전달되기 위해 필요한 정보입니다.

-   MAC 주소 = Media Access Control 주소

데이터 링크 계층에 해당하는 NIC에 내장된 물리적 주소로,

네트워크 장치의 고유 식별자입니다. 장치의 실명 인증과 비슷합니다.

같은 LAN 네트워크 안에서 프레임을 전송할 때 사용합니다.

---

## 📌 ARP

컴퓨터와 컴퓨터 간의 통신은 흔히들 IP 주소 기반으로 통신한다고 알고 있지만,

정확히는 IP 주소에서 ARP를 통해 MAC 주소를 찾아 MAC 주소를 기반으로 통신합니다.

-   **ARP**: IP 주소를 이용해 MAC 주소를 알아내는 프로토콜
-   **RARP**: MAC 주소를 이용해 IP 주소를 알아내는 프로토콜

<img width="600" height="297" alt="image" src="https://github.com/user-attachments/assets/6f9ae896-7d42-4c9f-9a22-e4d6ae815edb" />

<img width="600" height="433" alt="image" src="https://github.com/user-attachments/assets/dc35f70a-4869-4683-9805-f3527f176040" />

1.  장치 A가 IP 주소 \`120.70.80.3\`과 통신하려 함
    -   실제 데이터를 전달하려면 MAC 주소를 알아야 함
    -   IP 주소만 알고 있고, MAC 주소를 모르는 상태
2.  장치 A가 ARP Request 브로드캐스트를 네트워크 전체에 전송
    -   "이 IP 가진 장치 있나요? 있으면 MAC 주소를 알려주세요."
    -   브로드캐스트: 송신 호스트가 전송한 데이터가 네트워크에 연결된 모든 호스트에 전송되는 방식
3.  해당 IP를 가진 장치 B가 ARP Reply 유니캐스트를 전송해 MAC 주소를 알려줌
    -   "제 MAC 주소는 \`A6:BE:C4:D5:E7:F8\`입니다." 
    -   유니캐스트: 고유 주소로 식별된 하나의 네트워크 목적지에 1:1로 데이터를 전송하는 방식
4.  장치 A는 MAC 주소를 받아 ARP 테이블에 저장
    -   이후 동일 IP와 통신할 때는 ARP 요청 없이 바로  MAC 주소 사용
    -   ARP 테이블: 각 장치가 보유하는 IP-MAC 대응 정보 표

---

## 📌 홉바이홉 통신

-   네트워크에서 패킷이 전송될 때, IP 주소 기반 라우팅을 통해 여러 라우터를 거쳐 최종 목적지까지 도달합니다.  
    이 과정을 홉바이홉이라고 표현합니다.

홉(hop)이란 건너뛰는 모습을 뜻하는 단어로

패킷이 하나의 라우터를 거쳐 다음 장치로 이동하는 모습을 표현합니다.

<img width="600" height="330" alt="image" src="https://github.com/user-attachments/assets/f3e47b1c-0e4b-4f68-9c44-476ff8023acf" />

1.  패킷 헤더에는 도달해야 하는 최종 목적지의 IP 주소가 포함되어 있습니다.
2.  출발지에서 첫번째 라우터로 패킷을 보내면, 이 라우터에서 자신의 라우팅 테이블을 확인합니다.
3.  라우팅 테이블에서 최종 목적지로 가기 위한 최적 경로에 따라 다음에는 어느 라우터로 가야할지 찾아 패킷을 전달합니다.
4.  다음 라우터도 동일하게, 자신의 라우팅 테이블을 참고해 다음 라우터로 보냅니다.
5.  이러한 연속적인 라우팅 과정을 반복해, 패킷이 목적지에 도달합니다.

즉, 홉바이홉 통신은

연속적인 라우팅 과정을 거쳐 패킷이 최종 목적지까지 도달하는 과정을 의미합니다.

### 라우팅 테이블

송신지에서 수신지까지 도달하기 위해 사용되는,

라우터에 들어가 있는 목적지 정보들과 그 목적지로 가기 위한 방법이 들어 있는 리스트입니다.

모든 목적지에 대해 해당 목적지에 도달하기 위해 거쳐야 할 다음 라우터의 정보,

그리고 게이트웨이 정보를 가지고 있습니다.

### 게이트웨이

서로 다른 네트워크, 프로토콜을 사용하는 네트워크 간의 통신을 가능하게 하는 관문 역할을 하는 컴퓨터를 말합니다.

네트워크 사이를 연결해주는 중계 장치로, 일반적으로는 공유기라고 부릅니다.

<img width="600" height="197" alt="image" src="https://github.com/user-attachments/assets/9b20c7eb-d9f7-4c50-a888-27febaced1e8" />

사용자는 인터넷에 접소갛기 위해 수많은 톨게이트인 게이트웨이를 거쳐야 합니다.

게이트웨이는 서로 다른 네트워크 상의 통신 프로토콜을 변환해주는 역할도 합니다.

윈도우에서 \`netstat -r\` 명령어를 통해 라우팅 테이블을 확인할 수 있습니다.

<img width="716" height="525" alt="image" src="https://github.com/user-attachments/assets/ebc9538c-5320-41bb-b525-27924e73e94e" />

---

## 📌 IP 주소 체계

IP 주소는 IPv4와 IPv6으로 나누어지며 현재는 IPv4를 많이 사용합니다.

-   IPv4
    -   32비트 길이, 8비트 단위로 .을 찍어 표기
    -   ex) \`123.45.67.89\`
-   IPv6
    -   64비트 기이, 16비트 단위로 :을 찍어 표기
    -   ex) \`2001:db8:ff00:42:8329\`

### 클래스 기반 할당 방식

IPv4 사용 초창기에는 IP 주소를 개별적으로 조금씩 쪼개서 할당하지 못하고,

기관이나 기업이 IP 주소를 할당받으려면 클래스 단위로 통째로 받아야 했습니다.

이것을 클래스 기반 할당 방식이라고 합니다.

-   IP 주소를 A, B, C, D, E 다섯 개의 클래스로 구분하는 방식
-   앞 부분을 네트워크 주로, 나머지는 컴퓨터에 부여하는 호스트 주소로 사용
-   클래스 A, B, C는 일대일 통신으로 사용
-   클래스 D는 멀티캐스트 통신으로 사용
-   클래스 E는 예비용

<img width="681" height="323" alt="image" src="https://github.com/user-attachments/assets/14239d8d-e6fa-4b08-877e-eea7ba80ff53" />

각 클래스에서 가장 왼쪽에 있는 비트를 **구분 비트**라고 합니다.

클래스 A = 0, 클래스 B = 10, 클래스 C = 110 이런 식입니다.

이를 통해 클래스 간 IP 주소가 나누어집니다. 십진수로 표현하면 클래스 A에 속하는 IP 주소는 0~127 사잇값입니다.

이런 식으로 A 클래스에 할당할 수 잇는 주소는 약 1600만개, B 클래스는 약 65000개, C 클래스는 약 250개가 있습니다.

이 방식은 **사용하는 주소보다 버리는 주소가 많다는 문제점**이 있었습니다.

예를 들어, 어떤 회사에 PC가 300개가 있다고 가정해봅시다. PC마다 IP 주소를 부여해야 합니다.

C 클래스만으로는 300대에 모두 주소를 부여할 수 없습니다. 그래서 B 클래스까지 전체 할당받아야 합니다.

그래서 B 클래스에서는 C 클래스에서 쓰고 남은 약 50개 정도에 대해서만 사용하면 됩니다. 나머지 주소 수만 개는 그냥 놀게 됩니다.

IP 개수는 한정적인데 이렇게 사용하지 않는 IP 주소까지 통째로 소유하고 있다보니

다른 사용자는 해당 IP들을 사용하지 못하게 되어 **주소 고갈 문제**가 생겼습니다.

이 문제를 해소하기 위한 방법으로는 IPv6으로 더 많은 IP 주소를 사용하는 것과 DHCP, NAT 등이 있습니다.

### DHCP (Dynamic Host Configuration Protocol)

-   IP 주소 및 기타 통신 매개변수를 자동으로 할당하기 위한 네트워크 관리 프로토콜

이를 통해 네트워크 장치가 인터넷에 접속할 때마다

새로운 IP 주소가 자동으로 할당됩니다.

네트워크에 장치가 연결될 때마다 IP 주소를 임시로 할당하고, 연결이 끊기면 그 IP 주소를 회수하여

다른 장치에 재할당하여 한정적인 IP 주소를 유동적으로 사용할 수 있습니다.

### NAT (Network Address Translation)

-   패킷이 라우팅 장치를 통해 전송되는 동안 패킷의 IP 주소 정보를 수정하여 IP 주소를 다른 주소로 매핑하는 것

IPv4 주소 체계만으로 많은 주소들을 모두 감당하지 못하자

NAT로 공인 IP와 사설 IP로 나누어 많은 주소를 처리하게 됐습니다.

<img width="600" height="357" alt="image" src="https://github.com/user-attachments/assets/4d41d18a-0fcd-4ce6-a48f-fe169900dd41" />

위 그림에서 직원들은 모두 다른 IP 주소를 가지고 있습니다.

이 각각의 IP 주소를 **사설 IP**라고 합니다.

직원들은 NAT 장치를 통해 \`121.165.151.200\`이라는 하나의 IP를 가지고 외부 인터넷에 요청할 수 있습니다.

이 IP를 **공인 IP**라고 합니다.

이처럼 직원들은 하나의 IP인 \`121.165.151.200\`을 기반으로 각각의 다른 IP를 가지는 것처럼 인터넷을 사용할 수 있습니다.

여기서 바로 NAT 장치가 사설 IP와 공인 IP를 서로 변환해주는 역할을 합니다.

NAT을 사용함으로써,

여러 대의 호스트가 하나의 공인 IP 주소를 사용하여 인터넷에 접속할 수 있습니다.

또한 내부 네트워크에서 사용하는 IP 주소와 외부에 드러나는 IP 주소가 달라 어느 정도 보안을 유지할 수 있습니다.

그러나 NAT는 하나의 IP로 여러 명이 인터넷에 접속하게 되므로 접속하는 호스트 숫자에 따라 접속 속도가 느려질 수 있습니다.

---

## 📌 IP 주소를 이용한 위치 정보

IP 주소는 인터넷 세상에서의 집 주소라고 표현했습니다.

이를 통해 실제 지도 상에서의 주소를 추적할 수 있습니다.

[https://mylocation.co.kr/](https://mylocation.co.kr/)

---

## 🔑 요약

-   IP 주소: 네트워크 각 장치에 부여되는 논리적 주소로 목적지 식별을 위해 사용
-   MAC 주소: 장치마다 부여된 고유한 물리적 식별자 주소
-   ARP: IP 주소로 MAC 주소를 알아내 실제 데이터 전달을 가능하게 하는 프로토콜
-   RARP: MAC 주소로 IP 주소를 알아내는 프로토콜
-   홉바이홉: 패킷이 여러 라우터를 거쳐 목적지까지 단계별로 전달되는 과정
-   IP 주소 고갈: 클래스 할당 방식에서 생기는 문제
-   DHCP: IP 주소가 네트워크에 접속될 때마다 자동으로 할당되고, 접속 해제 시 회수되어 효율적으로 IP 주소 풀 관리
-   NAT: 한 개의 공인 IP와 여러 개의 사설 IP를 연결

## 👩‍🏫 예상 면접 질문

| IP 주소와 MAC 주소의 무엇인지 설명하세요. | P 주소는 네트워크 상에서 장치를 식별하기 위한 논리적 주소로,   서로 다른 네트워크 간 통신을 가능하게 해줍니다.      반면 MAC 주소는 네트워크 카드에 고유하게 할당된 물리적 주소로,   같은 네트워크(LAN) 내에서 실제 데이터 전달 시 사용됩니다.      즉, IP는 네트워크 간 이동을 위한 주소이고, MAC은 같은 네트워크 안에서 목적지를 찾는 데 사용됩니다. |
| --- | --- |
| 네트워크에서 ARP 프로토콜이 하는 역할은 무엇인가요? | IP 주소를 기반으로 실제 데이터를 전송할 수 있는 MAC 주소를 알아내는 역할입니다. |
| 라우터는 어떻게 패킷의 경로를 결정하나요? | 각 라우터는 라우팅 테이블을 기반으로 다음 목적지를 결정합니다.   라우팅 테이블에는 목적지 네트워크까지 최적의 경로로 가기 위한 다음 목적지 주소가 있습니다. |
| 클래스 기반 IP 주소 할당 방식에 대해 설명해보세요.    이 방식의 문제점은 무엇인가요? | IP 주소를 5가지 클래스로 구분하여 할당했습니다.   A 클래스는 매우 큰 약 1600만 개의 호스트, B 클래스는 약 6만 개, C 클래스는 약 250개의 호스트를 가지고 있었습니다.      이 방식은 필요한 수보다 훨씬 많은 주소가 할당되어 주소가 낭비되고, IP 주소가 고갈되는 문제가 생겼습니다. |

---
